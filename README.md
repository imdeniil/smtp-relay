# SMTP Relay - –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Version](https://img.shields.io/badge/version-2.0.0-blue.svg)](CHANGELOG.md)
[![Docker](https://img.shields.io/badge/docker-ready-brightgreen.svg)](https://www.docker.com/)
[![Production Ready](https://img.shields.io/badge/production-ready-success.svg)](#)
[![Quality Score](https://img.shields.io/badge/quality-95%2F100-brightgreen.svg)](docs/reports/OPTIMIZATION-REPORT.md)

Production-ready SMTP relay —Å–µ—Ä–≤–µ—Ä —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏, SASL –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –ø—Ä–æ—Å—Ç—ã–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º.

> **–í–µ—Ä—Å–∏—è 2.0** - –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤!
>
> üìä –°–º. [OPTIMIZATION-REPORT.md](docs/reports/OPTIMIZATION-REPORT.md) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

## –ù–∞–≤–∏–≥–∞—Ü–∏—è

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ë—ã—Å—Ç—Ä—ã–π –°—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ](#–∫–æ–º–∞–Ω–¥—ã-—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
- [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ù–µ–ø–æ–ª–∞–¥–æ–∫](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)
- [–£—á–∞—Å—Ç–∏–µ –≤ –ü—Ä–æ–µ–∫—Ç–µ](#—É—á–∞—Å—Ç–∏–µ-–≤-–ø—Ä–æ–µ–∫—Ç–µ)
- [–õ–∏—Ü–µ–Ω–∑–∏—è](#–ª–∏—Ü–µ–Ω–∑–∏—è)

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–î–≤–∞ –†–µ–∂–∏–º–∞ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è**
  - –ü–æ–ª–Ω—ã–π –°—Ç–µ–∫: nginx-proxy + acme-companion + smtp-relay
  - –¢–æ–ª—å–∫–æ SMTP: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º nginx-proxy

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ SSL –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Let's Encrypt
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ STARTTLS (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

- **SASL –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**
  - –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –ü—Ä–æ—Å—Ç–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

- **–ü–æ–ª–Ω–∞—è –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**
  - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
  - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
  - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è
  - –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

## –ë—ã—Å—Ç—Ä—ã–π –°—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/imdeniil/smtp-relay.git

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd smtp-relay
```

### 2. –°–¥–µ–ª–∞—Ç—å –°–∫—Ä–∏–ø—Ç—ã –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏

```bash
chmod +x deploy.sh manage.sh
```

### 3. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å

```bash
./deploy.sh
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ–¥–µ—Ç –≤–∞—Å —á–µ—Ä–µ–∑:
- –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (–ü–æ–ª–Ω—ã–π –°—Ç–µ–∫ –∏–ª–∏ –¢–æ–ª—å–∫–æ SMTP)
- –í—ã–±–æ—Ä –æ–ø—Ü–∏–∏ STARTTLS (—Å –∏–ª–∏ –±–µ–∑ TLS)
- –í–≤–æ–¥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
./manage.sh status
./manage.sh health
```

## –†–µ–∂–∏–º—ã –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –†–µ–∂–∏–º 1: –ü–æ–ª–Ω—ã–π –°—Ç–µ–∫

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ß–∏—Å—Ç—ã–π —Å–µ—Ä–≤–µ—Ä –±–µ–∑ nginx-proxy
- –ù—É–∂–Ω–∞ –ø–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –¢—Ä–µ–±—É–µ—Ç—Å—è reverse proxy –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**–ß—Ç–æ –ø–æ–ª—É—á–∏—Ç–µ:**
- nginx-proxy (reverse proxy)
- acme-companion (–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è Let's Encrypt)
- smtp-relay (SMTP —Å–µ—Ä–≤–µ—Ä)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- –†–µ—à–µ–Ω–∏–µ "–≤—Å—ë-–≤-–æ–¥–Ω–æ–º"

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
./deploy.sh
# –í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é 1 (–ü–æ–ª–Ω—ã–π –°—Ç–µ–∫)
```

### –†–µ–∂–∏–º 2: –¢–æ–ª—å–∫–æ SMTP

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –£–∂–µ –µ—Å—Ç—å —Ä–∞–±–æ—Ç–∞—é—â–∏–π nginx-proxy
- –•–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å SMTP –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–ª–µ–¥

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä [nginx-proxy](https://github.com/nginx-proxy/nginx-proxy) –∑–∞–ø—É—â–µ–Ω:
  ```bash
  docker run -d -p 80:80 -p 443:443 \
    --name nginx-proxy \
    --network proxy \
    -v /var/run/docker.sock:/tmp/docker.sock:ro \
    -v certs:/etc/nginx/certs:rw \
    nginxproxy/nginx-proxy
  ```
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä [acme-companion](https://github.com/nginx-proxy/acme-companion) –∑–∞–ø—É—â–µ–Ω:
  ```bash
  docker run -d \
    --name nginx-proxy-acme \
    --network proxy \
    --volumes-from nginx-proxy \
    -v /var/run/docker.sock:/var/run/docker.sock:ro \
    -v acme:/etc/acme.sh \
    -e "DEFAULT_EMAIL=your-email@example.com" \
    nginxproxy/acme-companion
  ```
- –°–µ—Ç—å "proxy" —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:
  ```bash
  docker network create proxy
  ```

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
./deploy.sh
# –í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é 2 (–¢–æ–ª—å–∫–æ SMTP)
```

## –û–ø—Ü–∏–∏ STARTTLS

### –° STARTTLS (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ SMTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã Let's Encrypt
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è
- DNS —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –ü–æ—Ä—Ç—ã 80 –∏ 443 –¥–æ—Å—Ç—É–ø–Ω—ã

### –ë–µ–∑ STARTTLS

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –û–±—ã—á–Ω—ã–µ SMTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –Ω–µ –Ω—É–∂–Ω—ã
- –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–°–ª—É—á–∞–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–µ—Ç–∏
- –¢–µ—Å—Ç–æ–≤—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ó–∞ –¥—Ä—É–≥–∏–º–∏ SSL —Ç–µ—Ä–º–∏–Ω–∞—Ç–æ—Ä–∞–º–∏

## –ö–æ–º–∞–Ω–¥—ã –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –°–µ—Ä–≤–∏—Å–æ–º

```bash
./manage.sh start          # –ó–∞–ø—É—Å—Ç–∏—Ç—å SMTP relay
./manage.sh stop           # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SMTP relay
./manage.sh restart        # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å SMTP relay
./manage.sh status         # –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å
./manage.sh logs           # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
./manage.sh logs -f        # –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

```bash
./manage.sh users          # –°–ø–∏—Å–æ–∫ SASL –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
./manage.sh add-user       # –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
./manage.sh del-user       # –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
./manage.sh reset-password # –°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```bash
./manage.sh test user@example.com  # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–∏—Å—å–º–æ
./manage.sh health                 # –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
./manage.sh diagnose              # –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
./manage.sh tls-check             # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å STARTTLS
```

### –û—á–µ—Ä–µ–¥—å –ü–æ—á—Ç—ã

```bash
./manage.sh queue          # –ü–æ–∫–∞–∑–∞—Ç—å –æ—á–µ—Ä–µ–¥—å –ø–æ—á—Ç—ã
./manage.sh flush          # –û—á–∏—Å—Ç–∏—Ç—å –æ—á–µ—Ä–µ–¥—å
./manage.sh stats          # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—á—Ç—ã
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –û–ø–µ—Ä–∞—Ü–∏–∏

```bash
./manage.sh backup         # –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
./manage.sh restore        # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
./manage.sh shell          # –û—Ç–∫—Ä—ã—Ç—å –æ–±–æ–ª–æ—á–∫—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
./manage.sh clean          # –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ (–û–ü–ê–°–ù–û)
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –û–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ:

```bash
cp .env.example .env
nano .env
```

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ù–∞—Å—Ç—Ä–æ–π–∫–∏:**

```bash
# –í–∞—à –¥–æ–º–µ–Ω
RELAY_MYHOSTNAME=relay.example.com
RELAY_MYDOMAIN=example.com
RELAY_POSTMASTER=postmaster@example.com

# Upstream SMTP (–∫—É–¥–∞ –ø–µ—Ä–µ—Å—ã–ª–∞—Ç—å –ø–∏—Å—å–º–∞)
RELAY_HOST=[smtp.gmail.com]:587
RELAY_LOGIN=your-email@gmail.com
RELAY_PASSWORD=your-password
RELAY_USE_TLS=yes

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ (–¥–ª—è –í–ê–®–ï–ì–û relay)
SASL_USERNAME=client-user@example.com
SASL_PASSWORD=client-password

# Let's Encrypt
LETSENCRYPT_EMAIL=admin@example.com

# –§—É–Ω–∫—Ü–∏–∏
ENABLE_STARTTLS=yes
SMTP_PORT=6025
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Email –ö–ª–∏–µ–Ω—Ç–æ–≤

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–∞—à–∏ email –∫–ª–∏–µ–Ω—Ç—ã:

```yaml
–°–µ—Ä–≤–µ—Ä:     relay.example.com (–∏–ª–∏ IP —Å–µ—Ä–≤–µ—Ä–∞)
–ü–æ—Ä—Ç:       6025
–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: STARTTLS (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: <SASL_USERNAME –∏–∑ .env>
–ü–∞—Ä–æ–ª—å:     <SASL_PASSWORD –∏–∑ .env>
```

## –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –ü–æ–ø—É–ª—è—Ä–Ω—ã—Ö –°–µ—Ä–≤–∏—Å–æ–≤

### Gmail

```bash
RELAY_HOST=[smtp.gmail.com]:587
RELAY_LOGIN=your-email@gmail.com
RELAY_PASSWORD=your-app-password  # –°–æ–∑–¥–∞–π—Ç–µ –Ω–∞ myaccount.google.com
RELAY_USE_TLS=yes
```

### SendGrid

```bash
RELAY_HOST=[smtp.sendgrid.net]:587
RELAY_LOGIN=apikey
RELAY_PASSWORD=SG.xxxxxxxxxxxxx
RELAY_USE_TLS=yes
```

### Mailgun

```bash
RELAY_HOST=[smtp.mailgun.org]:587
RELAY_LOGIN=postmaster@mg.example.com
RELAY_PASSWORD=your-mailgun-password
RELAY_USE_TLS=yes
```

### Amazon SES

```bash
RELAY_HOST=[email-smtp.us-east-1.amazonaws.com]:587
RELAY_LOGIN=your-ses-username
RELAY_PASSWORD=your-ses-password
RELAY_USE_TLS=yes
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```
smtp-relay/
‚îú‚îÄ‚îÄ deploy.sh                          # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ manage.sh                          # –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .env                              # –í–∞—à–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Å–æ–∑–¥–∞–π—Ç–µ –∏–∑ .env.example)
‚îú‚îÄ‚îÄ .env.example                      # –®–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.full.yml       # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Å—Ç–µ–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.smtp-only.yml  # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ SMTP
‚îÇ   ‚îî‚îÄ‚îÄ nginx-default.conf            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx helper
‚îî‚îÄ‚îÄ docs/
    ‚îú‚îÄ‚îÄ README.md                     # –≠—Ç–æ—Ç —Ñ–∞–π–ª
    ‚îú‚îÄ‚îÄ TROUBLESHOOTING.md           # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º
    ‚îî‚îÄ‚îÄ COMPARISON.md                 # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ù–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º—ã —Å –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ –ø–æ–ª—É—á–µ–Ω

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å DNS
dig +short relay.example.com

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ acme-companion
docker logs nginx-proxy-acme

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
./manage.sh cert-renew
```

**–ü—Ä–æ–±–ª–µ–º–∞:** STARTTLS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (TLS not available)

–ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É `4.7.0 TLS not available due to local problem`, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫ –¥–ª—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
./manage.sh fix-ssl-symlinks

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
./manage.sh tls-info

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å STARTTLS
./manage.sh tls-check

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
./manage.sh logs -f
```

**–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ:** –°–º. [SSL-CERTIFICATES-FIX.md](docs/SSL-CERTIFICATES-FIX.md) –¥–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–±–ª–µ–º–µ –∏ —Ä–µ—à–µ–Ω–∏–∏.

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –º–æ–≥—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ SMTP –ø–æ—Ä—Ç—É

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –æ—Ç–∫—Ä—ã—Ç –ª–∏ –ø–æ—Ä—Ç
nc -zv localhost 6025

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall
sudo ufw status
sudo ufw allow 6025/tcp

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
./manage.sh status
```

### –ü–æ–ª–Ω–∞—è –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∑–¥–æ—Ä–æ–≤—å—è
./manage.sh health

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
./manage.sh diagnose

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏
./manage.sh logs -f
```

## –†–µ–∑–µ—Ä–≤–Ω–æ–µ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### –°–æ–∑–¥–∞—Ç—å –†–µ–∑–µ—Ä–≤–Ω—É—é –ö–æ–ø–∏—é

```bash
./manage.sh backup
# –°–æ–∑–¥–∞–µ—Ç: backups/smtp-relay-backup-YYYYMMDD-HHMMSS.tar.gz
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –†–µ–∑–µ—Ä–≤–Ω—É—é –ö–æ–ø–∏—é

```bash
./manage.sh restore backups/smtp-relay-backup-20240101-120000.tar.gz
./manage.sh restart
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏** –¥–ª—è SASL –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
2. **–í–∫–ª—é—á–∏—Ç–µ STARTTLS** –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –æ–∫—Ä—É–∂–µ–Ω–∏–π
3. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø relay** —á–µ—Ä–µ–∑ `RELAY_MYNETWORKS`
4. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** —Ä–µ–≥—É–ª—è—Ä–Ω–æ —Å `./manage.sh stats`
5. **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å** - —Ä–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –æ–±—Ä–∞–∑—ã
6. **–î–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ó–¥–æ—Ä–æ–≤—å—è –°–µ—Ä–≤–∏—Å–∞

```bash
# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ç—É—Å
./manage.sh status

# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
./manage.sh health

# –ù–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –ª–æ–≥–∞–º–∏
./manage.sh logs -f
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ü–æ—Ç–æ–∫–∞ –ü–æ—á—Ç—ã

```bash
# –°—Ç–∞—Ç—É—Å –æ—á–µ—Ä–µ–¥–∏
./manage.sh queue

# –ù–µ–¥–∞–≤–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
./manage.sh stats

# –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏
docker logs smtp-relay | grep -i "sent"
```

## –£–¥–∞–ª–µ–Ω–∏–µ

### –£–¥–∞–ª–∏—Ç—å –¢–æ–ª—å–∫–æ SMTP

```bash
./manage.sh clean
```

### –£–¥–∞–ª–∏—Ç—å –ü–æ–ª–Ω—ã–π –°—Ç–µ–∫

```bash
# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker compose -f configs/docker-compose.full.yml down -v

# –£–¥–∞–ª–∏—Ç—å —Å–µ—Ç—å
docker network rm proxy
```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –û–±—â–∏–µ –ü—Ä–æ–±–ª–µ–º—ã

–°–º. `docs/TROUBLESHOOTING.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.

### –õ–æ–≥–∏

```bash
# –õ–æ–≥–∏ SMTP relay
./manage.sh logs

# –õ–æ–≥–∏ nginx-proxy
docker logs nginx-proxy

# –õ–æ–≥–∏ acme-companion
docker logs nginx-proxy-acme
```

### –†–µ–∂–∏–º –û—Ç–ª–∞–¥–∫–∏

```bash
# –í–∫–ª—é—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
docker exec smtp-relay postconf -e "smtpd_tls_loglevel=4"
./manage.sh restart
```

## –£—á–∞—Å—Ç–∏–µ –≤ –ü—Ä–æ–µ–∫—Ç–µ

–ú—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º –≤–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç! –°–º. [CONTRIBUTING.md](CONTRIBUTING.md) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

### –ö–∞–∫ –ø–æ–º–æ—á—å

- üêõ [–°–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ](https://github.com/yourusername/smtp-relay/issues/new?template=bug_report.md)
- üí° [–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ](https://github.com/yourusername/smtp-relay/issues/new?template=feature_request.md)
- üìñ –£–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- üîß –û—Ç–ø—Ä–∞–≤–∏—Ç—å pull request

### –£—á–∞—Å—Ç–Ω–∏–∫–∏

–°–ø–∞—Å–∏–±–æ –≤—Å–µ–º, –∫—Ç–æ –≤–Ω–æ—Å–∏—Ç –≤–∫–ª–∞–¥ –≤ —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç!

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- üìñ [README.md](README.md) - –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
- ‚ö° [QUICKSTART.ru.md](docs/QUICKSTART.ru.md) - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- üîß [SSL-CERTIFICATES-FIX.md](docs/SSL-CERTIFICATES-FIX.md) - –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å SSL
- üìä [OPTIMIZATION-REPORT.md](docs/reports/OPTIMIZATION-REPORT.md) - –û—Ç—á–µ—Ç –æ–± –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- üìù [CHANGELOG.md](CHANGELOG.md) - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ü§ù [CONTRIBUTING.md](CONTRIBUTING.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—á–∞—Å—Ç–∏—é

### –ê–Ω–≥–ª–∏–π—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- üìñ [docs/QUICKSTART.md](docs/QUICKSTART.md) - Quick Start
- üìä [docs/COMPARISON.md](docs/COMPARISON.md) - Deployment Comparison
- üîß [docs/TROUBLESHOOTING.md](docs/TROUBLESHOOTING.md) - Troubleshooting Guide

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- üß™ [docs/MANUAL-TEST.md](docs/MANUAL-TEST.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä—É—á–Ω–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- üî¨ [docs/TEST-REMOTE.md](docs/TEST-REMOTE.md) - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- üìã [docs/reports/GITHUB-READY-REPORT.md](docs/reports/GITHUB-READY-REPORT.md) - –û—Ç—á–µ—Ç –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ GitHub
- üìÅ [docs/reports/FILE-STRUCTURE-OPTIMIZATION.md](docs/reports/FILE-STRUCTURE-OPTIMIZATION.md) - –û—Ç—á–µ—Ç –æ–± –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–æ–≤

## –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

Copyright (c) 2025 SMTP Relay Project Contributors

## –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

–ü–æ—Å—Ç—Ä–æ–µ–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:
- [nginx-proxy](https://github.com/nginx-proxy/nginx-proxy) - Reverse proxy —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- [acme-companion](https://github.com/nginx-proxy/acme-companion) - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã Let's Encrypt
- [smtp-relay](https://github.com/Turgon37/docker-smtp-relay) - Docker –æ–±—Ä–∞–∑ –¥–ª—è SMTP relay

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- üìß Email: support@example.com
- üí¨ [Discussions](https://github.com/yourusername/smtp-relay/discussions)
- üêõ [Issues](https://github.com/yourusername/smtp-relay/issues)

---

**–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?** –ó–∞–ø—É—Å—Ç–∏—Ç–µ `./manage.sh help` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Å–ø—Ä–∞–≤–∫–∏.

**–ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç:**
```bash
./manage.sh test your-email@example.com
```

**–ó–≤–µ–∑–¥–∞ –Ω–∞ GitHub** ‚≠ê –µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –æ–∫–∞–∑–∞–ª—Å—è –ø–æ–ª–µ–∑–Ω—ã–º!
